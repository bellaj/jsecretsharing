package org.jsecretsharing.tests;

import static org.junit.Assert.*;

import java.security.SecureRandom;
import java.util.Arrays;
import java.util.List;

import org.jsecretsharing.Share;
import org.jsecretsharing.ShareBuilder;
import org.junit.Test;
import org.junit.experimental.runners.Enclosed;
import org.junit.runner.RunWith;

@RunWith(Enclosed.class)
public class ShareBuilderTest {
	@SuppressWarnings("serial")
	private static class FakeSecureRandom extends SecureRandom {
		@Override
		public synchronized void nextBytes(byte[] bytes) {
			Arrays.fill(bytes, (byte) 20);
		}
	}
	
	public static class A_New_Share_Builder {
		private ShareBuilder builder = new ShareBuilder("I am Batman. Seriously".getBytes(), 2, 512, new FakeSecureRandom());
		
		@Test
		public void itSplitsASecretIntoPieces() throws Exception {
			List<Share> shares = builder.build(3);
			assertEquals(3, shares.size());
			
			assertEquals(
				"01:14141414141414141414141414141414141414141414141414141414141414141414141414141" +
				"41414141414141414141414141414141414141414141414141414141414141414141414141414141" +
				"41414141414141414141414141414141414141414141414141414141414141414141414141414141" +
				"41414141414141414141414141414141414141414141414141414141414141414141414141414141" +
				"41414141414141414141414141414141414141414141414141414141414141414141414141414141" +
				"41414141414141414141414141414141414141414141414141414141414141414141414141414141" +
				"41414141414141414141414141414141414141414141414141414141414141414141414141414141" +
				"41414141414141414141414141414141414141414141414141414141414141414141414141414141" +
				"41414141414141414141414141414141414141414141414141414141414141414141414141414141" +
				"41414141414141414141414141414141414141414141414141414141414141414141414141414141" +
				"41414141414141414141414141414141414141414141414141414141414141414141414141414141" +
				"41414141414141414141414141414141414141414141414141414141414141414141414141414141" +
				"414141414141414141414145d3475813456758881758242346779867d838987808d",
				shares.get(0).toString()
			);
			
			assertEquals(
				"02:28282828282828282828282828282828282828282828282828282828282828282828282828282" +
				"82828282828282828282828282828282828282828282828282828282828282828282828282828282" +
				"82828282828282828282828282828282828282828282828282828282828282828282828282828282" +
				"82828282828282828282828282828282828282828282828282828282828282828282828282828282" +
				"82828282828282828282828282828282828282828282828282828282828282828282828282828282" +
				"82828282828282828282828282828282828282828282828282828282828282828282828282828282" +
				"82828282828282828282828282828282828282828282828282828282828282828282828282828282" +
				"82828282828282828282828282828282828282828282828282828282828282828282828282828282" +
				"82828282828282828282828282828282828282828282828282828282828282828282828282828282" +
				"82828282828282828282828282828282828282828282828282828282828282828282828282828282" +
				"82828282828282828282828282828282828282828282828282828282828282828282828282828282" +
				"82828282828282828282828282828282828282828282828282828282828282828282828282828282" +
				"8282828282828282828282871488995486a899c95899656487b8d9a91979d9b94a1",
				shares.get(1).toString()
			);
			
			assertEquals(
				"03:3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3" +
				"c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3" +
				"c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3" +
				"c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3" +
				"c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3" +
				"c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3" +
				"c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3" +
				"c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3" +
				"c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3" +
				"c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3" +
				"c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3" +
				"c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3c3" +
				"c3c3c3c3c3c3c3c3c3c3c3c855c9da95c7e9db0a99daa6a5c8fa1aea5abb1afa8b5",
				shares.get(2).toString()
			);
		}
	}
}
